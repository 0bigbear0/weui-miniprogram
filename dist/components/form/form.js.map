{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/components/form/form.ts?84ab","webpack:///./src/components/form/form-validator.ts","webpack:///./src/components/form/form.ts","webpack:///./src/components/form/validator.ts","webpack:///./src/components/utils/object.ts","webpack:///./src/components/utils/string.ts"],"names":["toString","Object","prototype","validateSingleRule","rule","value","param","models","message","ruleKeys","keys","i","l","length","ruleKey","validateMethod","validator","Validator","FormValidator","constructor","rules","errors","validate","cb","Promise","resolve","failCount","errorChanged","forEach","fieldName","oldError","_innerValidateField","valid","newError","diff","key","isValid","undefined","validateField","name","error","errObj","console","warn","isFail","call","resMessage","addMethod","ruleName","method","setModel","newModel","setRules","newRules","linked","target","data","prop","formItems","setInForm","firstItem","unlinked","Component","properties","type","observer","Array","extClass","String","relations","attached","initRules","formValidator","methods","setData","_modelChange","newVal","oldVal","diffObj","diffObject","errorMap","k","isValided","push","_showErrors","triggerEvent","trigger","_rulesChange","_showAllErrors","_showError","objs","formItem","showError","setError","handleError","handleErrors","v","newErrors","defaultMessage","required","minlength","maxlength","rangelength","bytelength","min","max","range","mobile","email","url","equalTo","isEmpty","val","r","sprintf","minlen","maxlen","test","len","replace","old","isDiff","args","result","para","reg","RegExp"],"mappings":"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","file":"components/form/form.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./node_modules/@mpflow/webpack-plugin/lib/loaders/page-loader.js?appContext=src&outputPath=components%2Fform%2Fform!./src/components/form/form.ts\");\n","module.exports = require(\"!./form.ts\")","import Validator from './validator'\nimport { diff } from '../utils/object'\n\nconst toString = Object.prototype.toString\nconst validateSingleRule = (rule: any, value: any, param: any = null, models = null) => {\n    let message = ''\n    const ruleKeys = Object.keys(rule)\n\n    for (let i = 0, l = ruleKeys.length; i < l; ++i) {\n        const ruleKey = ruleKeys[i]\n        if (ruleKey === 'name' || ruleKey === 'message') continue\n        const validateMethod =\n            typeof rule.validator !== 'undefined' ? rule.validator : Validator[ruleKey]\n        if (typeof validateMethod === 'function') {\n            message = validateMethod(rule, value, param, models)\n            if (message) {\n                return message\n            }\n        }\n    }\n    return message\n}\nclass FormValidator {\n    models: {}\n\n    rules: {}\n\n    errors: {}\n\n    constructor(models, rules) {\n        this.models = models\n        this.rules = rules\n        this.errors = {}\n    }\n\n    validate(): Promise<{ isValid: boolean; errors: any }>\n    validate(cb: (isValid: boolean, errors: any) => void): void\n    validate(cb?: any) {\n        return new Promise((resolve) => {\n            let failCount = 0\n            const errors = this.errors\n            const models = this.models\n            let errorChanged = false\n            Object.keys(this.rules).forEach((fieldName) => {\n                const oldError = errors[fieldName]\n                this._innerValidateField(fieldName, models[fieldName], (valid, newError) => {\n                    if (!valid) failCount++\n                    if (diff(oldError, newError)) {\n                        errors[fieldName] = newError\n                        errorChanged = true\n                    }\n                })\n            })\n            const keys = Object.keys(errors)\n            keys.forEach((key) => {\n                if (!errors[key]) delete errors[key]\n            })\n            // 先支持同步的接口吧\n            resolve({ isValid: !failCount, errors: failCount ? errors : undefined })\n            cb && cb(!failCount, failCount ? errors : undefined)\n        })\n    }\n\n    validateField(name: string, value: any): Promise<{ valid: boolean; error: any }>\n    validateField(name: string, value: any, cb: (isValid: boolean, errors: any[]) => void): void\n    validateField(name, value, cb?) {\n        return new Promise((resolve) => {\n            this._innerValidateField(name, value, (valid, error) => {\n                const errObj = {}\n                errObj[name] = error\n                resolve({ valid, error: valid ? undefined : error })\n                cb && cb(valid, valid ? undefined : errObj)\n                const oldError = this.errors[name]\n                const errorChanged = diff(oldError, error)\n                if (errorChanged) {\n                    if (!error) delete this.errors[name]\n                    this.errors[name] = error\n                }\n            })\n        })\n    }\n\n    _innerValidateField(name, value, cb) {\n        const rules = this.rules[name]\n        if (!rules) {\n            console.warn(`[form-validator] rule name ${name} not exists.`)\n            cb(true)\n            return\n        }\n        // 处理参数\n        if (typeof value === 'function') {\n            cb = value\n            value = undefined\n        }\n        let isFail = false\n        const models = this.models\n        if (toString.call(rules) === '[object Array]') {\n            rules.forEach((rule) => {\n                rule.name = name // 字段名称\n                const resMessage = validateSingleRule(\n                    rule,\n                    value || models[name],\n                    rule.param,\n                    models\n                )\n                // 失败了直接中止\n                if (resMessage && !isFail) {\n                    isFail = true\n                    // errors[name] = {message: resMessage}\n                    const error = resMessage ? { message: resMessage, rule } : undefined\n                    cb(false, error)\n                }\n            })\n            // 成功的回调\n            if (!isFail) {\n                cb(!isFail)\n            }\n        } else {\n            const rule = rules\n            rule.name = name\n            const resMessage = validateSingleRule(rule, value || models[name], rule.param, models)\n            const error = resMessage ? { message: resMessage, rule } : undefined\n            if (resMessage) {\n                isFail = true\n            }\n            cb(!isFail, error)\n        }\n    }\n\n    static addMethod(ruleName, method) {\n        Validator[ruleName] = method\n    }\n\n    setModel(newModel) {\n        this.models = newModel\n    }\n\n    setRules(newRules) {\n        this.rules = newRules\n    }\n}\nexport default FormValidator\n","import FormValidator from './form-validator'\nimport { diffObject } from '../utils/object'\n\nfunction linked(target) {\n    if (target.data.prop) {\n        this.data.formItems[target.data.prop] = target\n    }\n    if (target.setInForm) {\n        target.setInForm()\n    }\n    if (!this.data.firstItem) {\n        this.data.firstItem = target\n    }\n}\nfunction unlinked(target) {\n    if (target.data.prop) {\n        delete this.data.formItems[target.data.prop]\n    }\n}\n\nComponent({\n    properties: {\n        models: {\n            type: Object,\n            value: {},\n            observer: '_modelChange'\n        },\n        rules: {\n            // 格式是[{name, rules: {}}]\n            type: Array,\n            value: [],\n            observer: '_rulesChange'\n        },\n        extClass: {\n            type: String,\n            value: ''\n        }\n    },\n    data: {\n        errors: {},\n        formItems: {},\n        firstItem: null\n    },\n    relations: {\n        '../cell/cell': {\n            type: 'descendant',\n            linked,\n            unlinked\n        },\n        '../checkbox-group/checkbox-group': {\n            type: 'descendant',\n            linked,\n            unlinked\n        }\n    },\n    attached() {\n        this.initRules()\n        this.formValidator = new FormValidator(this.data.models, this.data.newRules)\n    },\n    methods: {\n        initRules(rules) {\n            const newRules = {}\n            ;(rules || this.data.rules).forEach((rule) => {\n                if (rule.name && rule.rules) {\n                    newRules[rule.name] = rule.rules || []\n                }\n            })\n            this.setData({ newRules })\n            return newRules\n        },\n        _modelChange(newVal, oldVal) {\n            if (!this.formValidator) {\n                return newVal\n            }\n            // 这个必须在前面\n            this.formValidator.setModel(newVal)\n            const diffObj: any = diffObject(oldVal, newVal)\n            if (diffObj) {\n                let isValid = true\n                const errors = []\n                const errorMap = {}\n                Object.keys(diffObj).forEach((k) => {\n                    this.formValidator.validateField(k, diffObj[k], function (isValided, error) {\n                        if (error && error[k]) {\n                            errors.push(error[k])\n                            errorMap[k] = error[k]\n                        }\n                        isValid = isValided\n                    })\n                })\n                this._showErrors(diffObj, errorMap)\n                this.triggerEvent(\n                    isValid ? 'success' : 'fail',\n                    isValid ? { trigger: 'change' } : { errors, trigger: 'change' }\n                )\n            }\n            return newVal\n        },\n        _rulesChange(newVal) {\n            const newRules = this.initRules(newVal)\n            if (this.formValidator) {\n                this.formValidator.setRules(newRules)\n            }\n            return newVal\n        },\n        _showAllErrors(errors) {\n            Object.keys(this.data.newRules).forEach((k) => {\n                this._showError(k, errors && errors[k])\n            })\n        },\n        _showErrors(objs, errors) {\n            Object.keys(objs).forEach((k) => {\n                this._showError(k, errors && errors[k])\n            })\n        },\n        _showError(prop, error) {\n            const formItem = this.data.formItems[prop]\n            if (formItem && formItem.data.showError) {\n                formItem.setError(error)\n            }\n        },\n        validate(cb) {\n            return this.formValidator.validate((isValid, errors) => {\n                this._showAllErrors(errors)\n                const handleError = this.handleErrors(errors)\n                this.triggerEvent(\n                    isValid ? 'success' : 'fail',\n                    isValid ? { trigger: 'validate' } : { errors: handleError, trigger: 'validate' }\n                )\n                cb && cb(isValid, handleError)\n            })\n        },\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        validateField(name, value, cb = (v, error = null) => {}) {\n            return this.formValidator.validateField(name, value, (isValid, errors) => {\n                this._showError(name, errors)\n                const handleError = this.handleErrors(errors)\n                this.triggerEvent(\n                    isValid ? 'success' : 'fail',\n                    isValid ? { trigger: 'validate' } : { errors: handleError, trigger: 'validate' }\n                )\n                cb && cb(isValid, handleError)\n            })\n        },\n        handleErrors(errors) {\n            if (errors) {\n                const newErrors = []\n                this.data.rules.forEach((rule) => {\n                    if (errors[rule.name]) {\n                        errors[rule.name].name = rule.name\n                        newErrors.push(errors[rule.name])\n                    }\n                })\n                return newErrors\n            }\n            return errors\n        },\n        addMethod(ruleName, method) {\n            return this.formValidator.addMethod(ruleName, method)\n        }\n    }\n})\nexport default FormValidator\n","import { sprintf } from '../utils/string'\n\nconst defaultMessage = {\n    required: '%s必填',\n    minlength: '长度最少为%s',\n    maxlength: '长度最大为%s',\n    rangelength: '长度在%s和%s之间',\n    bytelength: '最多只能输入%s个字',\n    min: '值最小为%s',\n    max: '值最大为%s',\n    range: '值的范围为%s和%s之间',\n    mobile: '请输入正确的手机号',\n    email: '请输入正确的电子邮件',\n    url: '请输入正确的URL地址',\n    equalTo: '值和字段%s不相等'\n}\n\nconst isEmpty = function (val): boolean {\n    if (val === 0 || val === false) return false\n    return !val\n}\n\nexport default {\n    required(r, val): string {\n        if (r.required === false) return ''\n        else if (isEmpty(val)) return sprintf(r.message || defaultMessage.required, r.name)\n        else return ''\n    },\n    minlength(r, val) {\n        const minlen = r.minlength\n        val = val || ''\n        if (val.length < minlen) return sprintf(r.message || defaultMessage.minlength, minlen)\n        else return ''\n    },\n    maxlength(r, val) {\n        const maxlen = r.maxlength\n        val = val || ''\n        if (val.length > maxlen) {\n            return sprintf(r.message || defaultMessage.maxlength, maxlen)\n        } else {\n            return ''\n        }\n    },\n    rangelength(r, val) {\n        const range = r.rangelength\n        val = val || ''\n        if (val.length > range[1] || val.length < range[0]) {\n            return sprintf(r.message || defaultMessage.rangelength, range[0], range[1])\n        } else {\n            return ''\n        }\n    },\n    min(r, val) {\n        const min = r.min\n        if (val < min) {\n            return sprintf(r.message || defaultMessage.min, min)\n        } else {\n            return ''\n        }\n    },\n    max(r, val) {\n        const max = r.max\n        if (val > max) {\n            return sprintf(r.message || defaultMessage.max, max)\n        } else {\n            return ''\n        }\n    },\n    range(r, val) {\n        const range = r.range\n        if (val < range[0] || val > range[1]) {\n            return sprintf(r.message || defaultMessage.range, range[0], range[1])\n        } else {\n            return ''\n        }\n    },\n    mobile(r, val) {\n        val = val || ''\n        if (r.mobile === false) {\n            return ''\n        } else if (val.length !== 11) {\n            return sprintf(r.message || defaultMessage.mobile)\n        } else {\n            return ''\n        }\n    },\n    email(r, value) {\n        if (r.email === false) return ''\n        // contributed by Scott Gonzalez: http://projects.scottsplayground.com/email_address_validation/\n        // eslint-disable-next-line\n    if (!/^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$/i.test(value)) {\n            return sprintf(r.message || defaultMessage.email)\n        } else {\n            return ''\n        }\n    },\n\n    // http://docs.jquery.com/Plugins/Validation/Methods/url\n    url(r, value) {\n        if (r.url === false) return ''\n        // contributed by Scott Gonzalez: http://projects.scottsplayground.com/iri/\n        if (\n            // eslint-disable-next-line no-useless-escape\n            !/^(https?|s?ftp|weixin):\\/\\/(((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:)*@)?(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5]))|((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.?)(:\\d*)?)(\\/((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)+(\\/(([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)*)*)?)?(\\?((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|[\\uE000-\\uF8FF]|\\/|\\?)*)?(#((([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(%[\\da-f]{2})|[!\\$&'\\(\\)\\*\\+,;=]|:|@)|\\/|\\?)*)?$/i.test(\n                value\n            )\n        ) {\n            return r.message || defaultMessage.url\n        } else {\n            return ''\n        }\n    },\n    equalTo(r, value, param, models) {\n        const equalTo = r.equalTo\n        if (value !== models[equalTo]) {\n            return sprintf(r.message || defaultMessage.equalTo, r.name)\n        } else {\n            return ''\n        }\n    },\n    bytelength(r, value, param) {\n        param = r.param\n        // eslint-disable-next-line no-control-regex\n        const len = value.replace(/[^\\x00-\\xff]/g, '**').length\n        if (len > param) {\n            return sprintf(r.message || defaultMessage.bytelength, param)\n        } else {\n            return ''\n        }\n    }\n}\n","export const diff = (old, newVal) => {\n    if ((!old && newVal) || (old && !newVal)) return true\n    for (const k in newVal) {\n        if (old[k] !== newVal[k]) return true\n    }\n    for (const k in old) {\n        if (old[k] !== newVal[k]) return true\n    }\n    return false\n}\nexport const diffObject = (old, newVal) => {\n    if (!old && newVal) return newVal\n    if (!newVal && old) return old\n    const diffObj = {}\n    let isDiff = false\n    for (const k in newVal) {\n        if (old[k] !== newVal[k]) {\n            isDiff = true\n            diffObj[k] = newVal[k]\n        }\n    }\n    for (const k in old) {\n        if (old[k] !== newVal[k]) {\n            isDiff = true\n            diffObj[k] = newVal[k]\n        }\n    }\n    return isDiff ? diffObj : null\n}\n","/**\n * 占位替换\n * @method sprintf\n * @method String.prototype.sprintf\n * @example\n * \"my name is %s  %s\".sprintf(\"a\",\"b\")  =》\"my name is a  b\"\n */\nexport const sprintf = (...args): string => {\n    let i\n    let result = args[0] || ''\n    let para\n    let reg\n    const length = args.length - 1\n\n    if (length < 1) {\n        return result\n    }\n\n    i = 1\n    while (i < length + 1) {\n        result = result.replace(/%s/, '{#' + i + '#}')\n        i++\n    }\n    result.replace('%s', '')\n\n    i = 1\n    // eslint-disable-next-line\n    while (true) {\n        para = args[i]\n        if (para === undefined) {\n            // 0 也是可能的替换数字\n            break\n        }\n        reg = new RegExp('{#' + i + '#}', 'g')\n        result = result.replace(reg, para)\n        i++\n    }\n    return result\n}\n"],"sourceRoot":""}